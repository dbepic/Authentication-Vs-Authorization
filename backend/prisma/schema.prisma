// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Profile {
  id        Int     @id @default(autoincrement())
  bio       String?
  skills    Json?
  education Json?
  resume    Json?

  // Relation to User
  userId Int  @unique(map: "ProfileTable_userId_key")
  user   User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("profiletable")
}

model User {
  id                Int        @id @default(autoincrement())
  username          String?
  lname             String?
  email             String     @unique(map: "UserTable_email_key")
  phone             String?
  password          String?
  role              UserRole   @default(user)
  status            UserStatus @default(active)
  isVerified        Boolean    @default(false)
  refreshToken      String?    @map("refresh_token") @db.Text
  googleId          String?    @unique(map: "UserTable_googleId_key")
  avatar            String?
  forgotpassword    Int?       @default(0)
  forgotpasswordExp DateTime?
  lastLogin         DateTime?  @map("LastLogin")

  // Relations
  profile   Profile?
  companies Company[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([email], map: "UserTable_email_idx")
  @@map("usertable")
}

model Company {
  id          Int     @id @default(autoincrement())
  companyName String? @map("companyNmae") // Mapping typo to DB field if necessary
  logo        String?
  description String?
  location    Json?

  // Relation to User
  userId Int
  user   User @relation(fields: [userId], references: [id])

  @@map("companyModel")
}

enum UserRole {
  user
  admin

  @@map("usertable_role")
}

enum UserStatus {
  active
  inactive

  @@map("usertable_status")
}
